{% extends "layout.html" %}

{% block deletetask %}
    <form action="/" method="post">
        <select name="id">
            {% for task in tasks %}
            <option value="{{ task.id }}" class="nav-item">{{ task. task }}</option>
            {% endfor %}
        </select>
        <button type="submit">Completed</button>
    </form>
{% endblock %}

{% block title %}
    Tasks
{% endblock %}

{% block main%}
    <h1 class="mb-3">TASKS:</h1>
    <table class="table table-striped sortable" data-toggle="table">
        <thead>
            <tr>
                <th data-sortable="true" scope="col">Task</th>
                <th scope="col">Deadline</th>
                <th scope="col">Created</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
            <tr>
                <td>{{ task.task }}</td>
                <td>{{ task.deadline }}</td>
                <td>{{ task.timestamp }}</td>
            </tr>
            <tr>
                <td>{{ task.task }}</td>
                <td>{{ task.deadline }}</td>
                <td>{{ task.timestamp }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% for task in tasks %}
        {% if task.importance == 1 %}
        <button type="button" class="collapsible bg-danger">{{ task.task }}</button>
        <div class="content">
            <textarea rows="10" cols="200">{{ task.detail }}</textarea>
            <p>Deadline: {{ task.deadline }}</p>
            <p>Created: {{ task.timestamp }}</p>
            <p class="alert alert-danger">IMPORTANT</p>
        </div>
        {% else %}
        <button type="button" class="collapsible">{{ task.task }}</button>
        <div class="content">
            <textarea rows="10" cols="200">{{ task.detail }}</textarea>
            <p>Deadline: {{ task.deadline }}</p>
            <p>Created: {{ task.timestamp }}</p>
        </div>
        {% endif %}
    {% endfor %}
    <script>
        var coll = document.getElementsByClassName("collapsible");
        var i;
        for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                content.style.display = "block";
                }
            });
        }
    </script>
{% endblock %}
